<!DOCTYPE html>
<html lang="en">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
<head>
    <title>Submit Form</title>
    <style>
        /* Some basic styles */
        body {
            font-family: Arial, sans-serif;
            margin: 0px;
            background-color: #121278eb;
            color: white;
            /* fot the texts use rgb(162, 255, 177)*/
        }
        
        /* Styles for the navigation bar */
        .navbar {
            background-color: #00003d;
            width: 100%;
            overflow: hidden;
            padding: 10px 0px;
        }
        
        .navbar a {
            float: right;
            color: white;
            text-align: center;
            padding: 12px 16px;
            text-decoration: none;
        }

    .navbar .login-btn {
    background-color: green; /* Color when hovered */
    }
    textarea {
    font-family: 'Times New Roman', serif;
    font-size: 18px;

}


        .login-btn {
        background-color: #4CAF50;
        color: white;
        border: none;
        border-radius: 4px;
        padding: 10px 15px;
        cursor: pointer;
        transition: background-color 0.3s ease; 
     }

        .login-btn:hover {
         background-color: #45a049;
        }


        /* Style for the word count error message */
        .word-count-error {
            color: red;
            display: none;  /* Initially hidden */
        }
        
        /* Centering the form on the page */
        form {
            max-width: 600px;
            margin: 40px auto;
            padding: 20px;
            border-radius: 20px;
            box-shadow: 2px 2px 12px rgba(0, 0, 0, 0.1);
        }

        label, input, textarea {
            width: 100%;
            padding: 8px;
            margin-bottom: 10px;
            box-sizing: border-box;
        }
        label{
            color: rgb(162, 255, 177);
        }
        input, textarea{
            background-color: #7b7bc5;
        }

        #teamSize option {
        background-color: #7b7bc5;
    }
        ::-webkit-input-placeholder {
    color: #ffffff;
}
#teamSize{
    background-color: #7b7bc5;
}
#Year, #Year2{
    background-color: #7b7bc5;
}
        #countdown {
            background-color: #f2f2f2;
            color: red;
            font-size: 1.5em;
            padding: 10px;
            text-align: center;
            margin-top: 20px;
        }
        input[type="submit"] {
        background-color: #4CAF50;
        color: white;
        border: none;
        border-radius: 4px;
        padding: 10px 15px;
        cursor: pointer;
        width: 100%;
        }

        input[type="submit"]:hover {
        background-color: #45a049;
        }
        #abstract {
        width: 100%;
        height: 400px;  /* Adjust height to fit more content */
        padding: 10px;
        border: 1px solid #ccc;
        border-radius: 4px;
        box-shadow: 2px 2px 6px rgba(0, 0, 0, 0.1);
        resize: vertical; /* Allows the user to resize the textarea vertically */
        overflow-y: auto; /* Shows a scrollbar when the content is bigger than the textarea height */
        }

    span[id$="Error"] {
    margin: 0px;  /* Adjust this value to your liking */
    margin-top: 5px;
    display: block;
    font-size: 10px;
    }
    
    .person1{
        border: 2px solid #00000076;
        padding: 50px;
    }

    .person2{
        border: 2px solid #00000076;
        padding: 50px;
        margin: 50px 0px;
        display: none; /* Initially hide Person 2 information */

    }
    


    </style>
</head>
<body>
    <div class="navbar">
        <a href="/admin" class="login-btn" style="padding: 30px; border-radius: 20px;">Login</a>
        <span style="float:right; padding-top:15px; margin-right: 5px; padding: 30px;">Are you admin?</span>
    </div>


    <h1 style="margin-left: 20px; text-align: center;;">Welcome! Submit Your Abstract</h1>

    <form action="/submit" method="post" onsubmit="return validateForm()" id="form">
        <h2>- Your information:</h2>
        <div class="person1">
        <label for="name">Name:</label>
        <input type="text" id="name" name="name"><br>
        <span id="nameError" style="color: red; display: none;">Name is required.</span>
        
        
        <label for="phone">Phone:</label>
        <input type="tel" id="phone" name="phone"><br>
        <span id="phoneError" style="color: red; display: none;">Phone is required.</span>

        
        <label for="nationality">Nationality:</label>
        <input type="text" id="nationality" name="nationality"><br>
        <span id="nationalityError" style="color: red; display: none;">Nationality is required.</span>

        
        <label for="university">University:</label>
        <input type="text" id="university" name="university"><br>
        <span id="universityError" style="color: red; display: none;">university is required.</span>

        <label for="Year">Year of the study:</label>
        <select name="Year" id="Year">
            <option value="1">1</option>
        <option value="2">2</option>
        <option value="3">3</option>
        <option value="4">4</option>
        <option value="5">5</option>
        <option value="6">6</option>
        </select>

       
       
        </div>
        <div style="padding: 40px; ">
        <label for="teamSize">Are you working on this:</label>
        <select id="teamSize" name="teamSize" onchange="toggleTeamSize()">
        <option value="1" id="alone">Alone</option>
        <option value="2" id="no">Someone with me</option>
        </select>
        <br><br>
        </div>

        

        <div class="person2">
        <h2>- Second person information:</h2>

        <label for="name2">Name:</label>
        <input type="text" id="name2" name="name2"><br>
        <span id="name2Error" style="color: red; display: none;">Name is required.</span>

    
        
        
        <label for="phone2">Phone:</label>
        <input type="tel" id="phone2" name="phone2"><br>
        <span id="phone2Error" style="color: red; display: none;">Phone is required.</span>

     

        
        <label for="nationality2">Nationality:</label>
        <input type="text" id="nationality2" name="nationality2"><br>
        <span id="nationality2Error" style="color: red; display: none;">Nationality is required.</span>
        

        
        <label for="university2">University:</label>
        <input type="text" id="university2" name="university2"><br>
        <span id="university2Error" style="color: red; display: none;">university is required.</span>

        <label for="Year2">Year of the study:</label>
        <select name="Year2" id="Year2">
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5</option>
            <option value="6">6</option>
        </select>
        

        </div>
        <div class="genral">
        <h2>General information:</h2>
       <div style="margin-top: 20px;"></div>

        <label for="email">Email:</label>
        <input type="email" id="email" name="email"><br>
        <span id="emailError" style="color: red; display: none;">Email is required.</span>
        </div>
        <label for="ResearchSpecialty">Research specialty:</label>
        <input type="text" id="ResearchSpecialty" name="ResearchSpecialty"><br>
        <span id="ResearchSpecialtyError" style="color: red; display: none;">Research specialty is required.</span>

        
        <label for="doctorName">Name of the doctor:</label>
        <input type="text" id="doctorName" name="doctorName"><br>
        <span id="doctorNameError" style="color: red; display: none;">Name of the doctor is required.</span>

        
        <label for="title">Title:</label>
        <input type="text" class="form-control" id="title" name="title">
        <span id="titleError" style="color: red; display: none;">Title is required.</span>
        
        <label for="abstract">The Abstract:</label>
        <textarea id="abstract" name="abstract" rows="4" cols="50" oninput="checkWordCount()" placeholder="200 words maximum "></textarea><br>
        <span id="wordCountDisplay">0/200</span>
        <span id="abstractError" style="color: red; display: none;">Abstract is required.</span>
        <div id="deadlineError" style="color: red; text-align: center; display: none;">
            Deadline has passed
        </div>        
        <div class="word-count-error">The abstract must be 200 words or less.</div>
        <input type="submit" value="Submit">

        </div>
    </form>
    
    <div id="countdown">
        <strong>Deadline: </strong>
        <span id="days">0</span> days,
        <span id="hours">0</span> hours,
        <span id="minutes">0</span> minutes,
        <span id="seconds">0</span> seconds
    </div>
    <script>   
    function validateForm() {
        const now = new Date().getTime();
        const deadlineElement = document.getElementById('countdown');

    // If the deadline has expired
    if (deadlineElement && deadlineElement.innerHTML === "EXPIRED") {
        document.getElementById("deadlineError").style.display = "block";
        alert("The deadline has passed. Your changes won't be saved.");
        return false;  // prevent form submission
    }
        const name = document.getElementById("name").value;
        const email = document.getElementById("email").value;
        const phone = document.getElementById("phone").value;
        const nationality= document.getElementById("nationality").value;
        const university=document.getElementById("university").value;
        const Year=document.getElementById("Year").value;
        const ResearchSpecialty=document.getElementById("ResearchSpecialty").value;
        const doctorName=document.getElementById("doctorName").value;
        const title = document.getElementById("title").value;
        const abstract = document.getElementById("abstract").value;
        
        let isValid = true;
    
        // Check each field
        if (!name) {
            document.getElementById("nameError").style.display = "block";
            isValid = false;
        } else {
            document.getElementById("nameError").style.display = "none";
        }
    
        if (!email) {
            document.getElementById("emailError").style.display = "block";
            isValid = false;
        } else {
            document.getElementById("emailError").style.display = "none";
        }
    
        if (!phone) {
            document.getElementById("phoneError").style.display = "block";
            isValid = false;
        } else {
            document.getElementById("phoneError").style.display = "none";
        }
        if(!nationality){
            document.getElementById("nationalityError").style.display = "block";
            isValid = false;
        } else {
            document.getElementById("nationalityError").style.display = "none";
        }
        if (!university) {
            document.getElementById("universityError").style.display = "block";
            isValid = false;
        } else {
            document.getElementById("universityError").style.display = "none";
        }

    
        if (!ResearchSpecialty) {
            document.getElementById("ResearchSpecialtyError").style.display = "block";
            isValid = false;
        } else {
            document.getElementById("ResearchSpecialtyError").style.display = "none";
        }
        if (!doctorName) {
            document.getElementById("doctorNameError").style.display = "block";
            isValid = false;
        } else {
            document.getElementById("doctorNameError").style.display = "none";
        }
        if (!title) {
            document.getElementById("titleError").style.display = "block";
            isValid = false;
        } else {
            document.getElementById("titleError").style.display = "none";
        }
    
        if (!abstract) {
            document.getElementById("abstractError").style.display = "block";
            isValid = false;
        } else {
            document.getElementById("abstractError").style.display = "none";
        }

    const teamSize = document.getElementById('teamSize').value;

    // If team size is 2, validate the fields for Person 2
    if (teamSize == "2") {
        const name2 = document.getElementById("name2").value;
        const phone2 = document.getElementById("phone2").value;
        const nationality2=document.getElementById("nationality2").value;
        const university2=document.getElementById("university2").value;
        const Year2=document.getElementById("Year2").value;
        // Add similar checks for other fields of Person 2

        if (!name2 && teamSize==2) {
            document.getElementById("name2Error").style.display = "block";
            isValid = false;
        } else {
            document.getElementById("name2Error").style.display = "none";
        }

        if (!phone2 && teamSize==2) {
            document.getElementById("phone2Error").style.display = "block";
            isValid = false;
        } else {
            document.getElementById("phone2Error").style.display = "none";
        }
        if (!nationality2 && teamSize==2) {
            document.getElementById("nationality2Error").style.display = "block";
            isValid = false;
        } else {
            document.getElementById("nationality2Error").style.display = "none";
        }

        if (!university2 && teamSize==2) {
            document.getElementById("university2Error").style.display = "block";
            isValid = false;
        } else {
            document.getElementById("university2Error").style.display = "none";
        }
    
    
        // Check abstract word count
        const wordCount = abstract.trim().split(/\s+/).length;
if (wordCount > 200) {
    alert("The abstract must be 200 words or less.");
    isValid = false;
}

    }
    return isValid;

}

    function toggleTeamSize() {
    const teamSize = document.getElementById('teamSize').value;
    const person2Div = document.querySelector('.person2');

    if (teamSize == "2") {
        person2Div.style.display = 'block';
    } else {
        person2Div.style.display = 'none';
    }
}
    
function checkWordCount() {
    const textarea = document.getElementById('abstract');
    const wordCount = textarea.value.split(/\s+/).filter(Boolean).length;
    const wordCountDisplay = document.getElementById('wordCountDisplay');
    const submitButton = document.querySelector('input[type="submit"]');
    
    wordCountDisplay.textContent = wordCount + "/200";
    if (wordCount > 200) {
        wordCountDisplay.style.color = 'red';
        submitButton.disabled = true; // Disables the submit button if word count is exceeded.
    } else {
        wordCountDisplay.style.color = 'black';
        submitButton.disabled = false;
    }
}

   
    
    
document.addEventListener("DOMContentLoaded", function(event) {
        // On document ready, fetch the deadline and start countdown
        fetch("/get-deadline")
            .then(res => res.json())
            .then(data => {
                console.log("Fetched deadline:", data);

            const deadline = new Date(data.deadline);
            
            let countdownInterval = setInterval(function() {
                const now = new Date().getTime();
                const distance = deadline - now;
                
                const days = Math.floor(distance / (1000 * 60 * 60 * 24));
                const hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                const minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
                const seconds = Math.floor((distance % (1000 * 60)) / 1000);

                document.getElementById('days').textContent = days;
                document.getElementById('hours').textContent = hours;
                document.getElementById('minutes').textContent = minutes;
                document.getElementById('seconds').textContent = seconds;
                
                if (distance < 0) {
                    clearInterval(countdownInterval); // changed 'this' to 'countdownInterval'
                    document.getElementById('countdown').innerHTML = "EXPIRED";
                }
            }, 1000);
        });
        toggleTeamSize();

});

(function() {

// Your functions: validateForm, toggleTeamSize, checkWordCount remain unchanged here

// Add the event listeners:

document.getElementById("form").addEventListener("submit", function(event) {
    if (!validateForm()) {
        event.preventDefault();  // Stop form submission if not valid
    }
});

document.getElementById("teamSize").addEventListener("change", toggleTeamSize);

document.getElementById("abstract").addEventListener("keyup", checkWordCount);
document.getElementById("abstract").addEventListener("change", checkWordCount);

})();
    </script>
</body>
</html>